--- /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/ping.php	2025-11-18 12:35:17
+++ /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/artifacts/exploits/vul2/fixed_ping.php	2025-11-15 22:38:38
@@ -10,7 +10,7 @@
     if (preg_match('/[&|><`$!]/', $host)) {
         $output = "Invalid characters detected.";
     } else {
-        $output = shell_exec("ping -c 1 $host 2>&1");
+        $output = shell_exec("ping -c 1 " . escapeshellarg($host));
     }
 }
 ?>
@@ -37,4 +37,4 @@
   <pre><?= $output ?? '' ?></pre>
 </section>
 
-<?php site_footer(); ?>
\ No newline at end of file
+<?php site_footer(); ?>
