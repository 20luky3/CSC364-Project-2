- Category: Local File Inclusion (source: https://www.invicti.com/learn/local-file-inclusion-lfi)
- Root Cause: In archive.php, it directly decodes the string and gets content for a vaid file path without checking that it's within a safe directory with `file_get_contents($path);` , so an attacker can use this to read any file on the server like source code or even /etc/passwd
- Fix: We get the absolute path of the decoded token, and check that its not within the logs directory with `strpos($full_target_path, realpath(__DIR__ . '/logs') !== 0`, and if so, it doesn't allow reading the content.