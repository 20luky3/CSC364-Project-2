--- /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/register.php	2025-11-18 12:45:03
+++ /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/artifacts/exploits/vul3/fixed_register.php	2025-11-15 23:06:05
@@ -1,4 +1,4 @@
-<?php require 'utils.php'; require 'db.php'; site_header('Register'); if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $sql="INSERT INTO users(username,password) VALUES ('{$_POST['username']}', '{$_POST['password']}')"; try { $db->exec($sql); echo "<section class='card'><h2>Account ready</h2><p class='muted'>You can sign in right away.</p><div class='form-actions'><a class='btn primary' href='login.php'>Proceed to login</a></div></section>"; site_footer(); exit; } catch(Exception $e){ echo "<section class='card'><div class='alert'>Error: ".htmlspecialchars($e->getMessage())."</div></section>"; site_footer(); exit; }} ?>
+<?php require 'utils.php'; require 'db.php'; site_header('Register'); if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db();$hashed = password_hash($_POST['password'], PASSWORD_DEFAULT); $sql = "INSERT INTO users(username,password) VALUES ('{$_POST['username']}', '$hashed')"; try { $db->exec($sql); echo "<section class='card'><h2>Account ready</h2><p class='muted'>You can sign in right away.</p><div class='form-actions'><a class='btn primary' href='login.php'>Proceed to login</a></div></section>"; site_footer(); exit; } catch(Exception $e){ echo "<section class='card'><div class='alert'>Error: ".htmlspecialchars($e->getMessage())."</div></section>"; site_footer(); exit; }} ?>
 
 <section class="page-header">
   <h1 class="page-title">Join the Console</h1>
@@ -26,4 +26,4 @@
   </form>
 </section>
 
-<?php site_footer(); ?>
\ No newline at end of file
+<?php site_footer(); ?>
