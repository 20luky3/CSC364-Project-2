--- /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/login.php	2025-11-18 12:44:41
+++ /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/artifacts/exploits/vul3/fixed_login.php	2025-11-15 23:05:48
@@ -1,4 +1,4 @@
-<?php require 'utils.php'; require 'db.php'; $error=null; if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $sql="SELECT * FROM users WHERE username = '{$_POST['username']}' AND password = '{$_POST['password']}' LIMIT 1;"; $row=$db->query($sql)->fetch(PDO::FETCH_ASSOC); if($row){ $_SESSION['user']=$row; header('Location:index.php'); exit; } else { $error='Invalid credentials'; }} site_header('Login'); ?>
+<?php require 'utils.php'; require 'db.php'; $error=null; if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $sql="SELECT * FROM users WHERE username = '{$_POST['username']}' LIMIT 1;"; $row=$db->query($sql)->fetch(PDO::FETCH_ASSOC); if($row&& password_verify($_POST['password'], $row['password'])){ $_SESSION['user']=$row; header('Location:index.php'); exit; } else { $error='Invalid credentials'; }} site_header('Login'); ?>
 
 <section class="page-header">
   <h1 class="page-title">Welcome back</h1>
