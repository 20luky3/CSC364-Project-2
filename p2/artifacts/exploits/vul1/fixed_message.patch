--- /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/message.php	2025-11-12 20:52:58
+++ /Users/anubhajoshi/CSC364-Project-2-Source-Code/p2/artifacts/exploits/vul1/fixed_message.php	2025-11-12 20:52:07
@@ -1,4 +1,4 @@
-<?php require 'utils.php'; require_login(); require 'db.php'; if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $uid=current_user()['id'];  $content = htmlspecialchars($_POST['content'], ENT_QUOTES, 'UTF-8'); $stmt=$db->prepare('INSERT INTO messages(user_id, content) VALUES (?, ?)'); $stmt->execute([$uid, $_POST['content']]); header('Location:index.php'); exit; } site_header('Post Message'); ?>
+<?php require 'utils.php'; require_login(); require 'db.php'; if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $uid=current_user()['id'];  $content = htmlspecialchars($_POST['content'], ENT_QUOTES, 'UTF-8'); $stmt=$db->prepare('INSERT INTO messages(user_id, content) VALUES (?, ?)'); $stmt->execute([$uid, $content]); header('Location:index.php'); exit; } site_header('Post Message'); ?>
 
 <section class="page-header">
   <h1 class="page-title">Compose Transmission</h1>
